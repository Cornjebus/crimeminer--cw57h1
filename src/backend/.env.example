# Node Environment
# REQUIRED: Application environment (development | staging | production)
NODE_ENV=${NODE_ENV}

# API Configuration
PORT=3000

# Authentication Service Configuration (CJIS & FedRAMP compliant)
KEYCLOAK_AUTH_URL=https://auth.example.com/auth
KEYCLOAK_REALM=crimeminer
KEYCLOAK_CLIENT_ID=crimeminer-backend
KEYCLOAK_CLIENT_SECRET=${KEYCLOAK_SECRET}

# Database Configuration (FedRAMP High compliant)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=crimeminer
POSTGRES_USER=${DB_USER}
POSTGRES_PASSWORD=${DB_PASSWORD}
POSTGRES_SSL=true
POSTGRES_SSL_REJECT_UNAUTHORIZED=true
POSTGRES_SSL_CA=/path/to/ca.crt

# Search Service Configuration
ELASTICSEARCH_NODE=https://es.example.com
ELASTICSEARCH_USER=${ES_USER}
ELASTICSEARCH_PASSWORD=${ES_PASSWORD}
ELASTICSEARCH_INDEX_PREFIX=crimeminer
ELASTICSEARCH_SSL=true
ELASTICSEARCH_SSL_VERIFY=true

# Storage Service Configuration
# AWS Primary Storage (FedRAMP High)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY}
AWS_SECRET_ACCESS_KEY=${AWS_SECRET_KEY}
AWS_S3_BUCKET=crimeminer-evidence
AWS_KMS_KEY_ID=${KMS_KEY_ID}
AWS_S3_FORCE_PATH_STYLE=true
AWS_S3_SERVER_SIDE_ENCRYPTION=AES256

# Azure Backup Storage (DR Configuration)
AZURE_STORAGE_CONNECTION_STRING=${AZURE_STORAGE_CONN}
AZURE_CONTAINER_NAME=crimeminer-backup
AZURE_STORAGE_ACCOUNT_NAME=${AZURE_STORAGE_ACCOUNT}
AZURE_STORAGE_ACCOUNT_KEY=${AZURE_STORAGE_KEY}
AZURE_STORAGE_USE_MANAGED_IDENTITY=true

# Redis Cache Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_TLS=true
REDIS_REJECT_UNAUTHORIZED=true
REDIS_KEY_PREFIX=crimeminer

# Logging Configuration (CJIS Compliant)
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=/var/log/crimeminer
LOG_MAX_SIZE=100m
LOG_MAX_FILES=30
LOG_AUDIT_TRAIL=true

# Security Configuration (FedRAMP Controls)
JWT_SECRET=${JWT_SECRET}
JWT_EXPIRY=900
REFRESH_TOKEN_EXPIRY=604800
SESSION_SECRET=${SESSION_SECRET}
COOKIE_SECRET=${COOKIE_SECRET}
COOKIE_SECURE=true
COOKIE_HTTP_ONLY=true
COOKIE_SAME_SITE=strict

# Rate Limiting (DoS Protection)
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_SKIP_TRUSTED=false

# Evidence Processing Configuration
MAX_FILE_SIZE=1073741824
SUPPORTED_MIME_TYPES=audio/*,video/*,image/*,application/pdf,text/*
FILE_SCAN_ENABLED=true
VIRUS_SCAN_COMMAND=/usr/bin/clamscan

# Compliance Settings
FIPS_COMPLIANT=true
CJIS_AUDIT_ENABLED=true
FEDRAMP_CONTROLS_ENABLED=true
DATA_CLASSIFICATION_LEVEL=high
ENCRYPTION_AT_REST=true
ENCRYPTION_IN_TRANSIT=true

# Monitoring and Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
HEALTH_CHECK_PATH=/health
READINESS_CHECK_PATH=/ready
LIVENESS_CHECK_PATH=/live

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_FREQUENCY=86400
BACKUP_RETENTION_DAYS=90
BACKUP_ENCRYPTION_KEY=${BACKUP_KEY}

# Geographic Restrictions
ALLOWED_REGIONS=us-east-1,us-west-2
GEO_FENCING_ENABLED=true
ALLOWED_COUNTRIES=US